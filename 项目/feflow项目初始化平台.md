项目初始步骤：
- 配置项目jsonSchema（项目基础信息、项目模板、工具服务）
- 插件初始化工作
  - 判断项目中使用的插件是否已经安装，初始相关依赖
  - 插件内部耗时任务，先执行（数据上报相关，上报项目id新建）
- 生成插件渲染任务写入任务列表中
- 执行渲染任务
  - 配置写入插件内，将文件内容存放到内存中
  - 根据内容内容，生成项目文件
- git操作
  - 对应的gitGroup下创建项目
  - 代码上传
  - 项目成员写入
  - ci工具接入（如果有用的话）

项目初始过程会用到两类插件：项目模板插件、工具服务插件。  
插件安装方式：
- 项目模板：只支持npm安装方式
- 工具服务：支持npm和cdn连接引入两种方式（平台建议工具服务两种方式都提供，引用方式需要工具服务来支持），服务端只支持npm方式

## 插件初始化
判断服务器根目录是否已经安装当前使用的插件，如果不存在，就安装相应的插件。

执行插件根目录下的渲染函数，如果插件不依赖其他服务中的数据，就可以调用cli的渲染函数，并将插件需要使用的数据传入。如果插件渲染依赖其他服务，我们可以在插件渲染函数中执行额外操作，例如tam，在项目初始过程中我们需要为项目申请一个id，就需要向请求tam创建项目服务，当tam项目创建成功后，再执行cli渲染函数，并将插件初始需要的数据和插件执行依赖的包信息传入。

## 生成插件渲染任务
插件初始成功以后，调用cli渲染函数时，需要将插件渲染时需要的参数传入，如果是工具服务插件需要传入使用哪种方式插入到项目中去。cli中生成任务渲染函数中，需要将插件数据都存起来，以便后续插件渲染的时候用到，目前项目中使用的闭包来存放的数据。

## 执行渲染任务
### 使用ejs，将数据插入文件内容
读取任务，然后并行执行渲染任务。这里首先是将所有插件文件内容都读出来，然后使用ejs将插件初始过程中得到的数据插入到插件文件内容中，并将最新的文件内容与当前文件相对路径放到内存中。

### 生成项目文件
web项目中，部分工具服务可以通过sdk引入插件资源文件，因此在遇到html文件的时候，判断是否有需要插入到html中的sdk，如果有的话，这里使用jsdom将文档转成可以使用dom操作的文本。这里插件使用script引用的配置在插件初始完成后调用渲染函数时传入了，script可以插到head或者body标签中，由于插件之前可能存在依赖关系，这里提供一个权重功能，权重高插入的位置就比权重低的插件要更靠前。

获取工具服务目录中所有工具调用文件，生成引入工具服务文件内容（例如`import './tam'`），在工具服务目录下生成index文件并将刚才的内容写入，修改项目模板入口文件内容，在文件头部引用工具服务目录下的index文件。这样项目就基本生成完成。

工具服务依赖写入项目：工具插件初始过程定义，插件调用需要使用的依赖，然后调用渲染函数的时候将依赖传入，向项目的package.json写入工具插件的依赖。